(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4848],{17090:(e,t,a)=>{Promise.resolve().then(a.bind(a,21736))},21736:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var s=a(95155),l=a(42414),n=a(57791),o=a(97458),r=a(1584),i=a(36768),c=a(30832),d=a.n(c),u=a(42376),m=a.n(u),h=a(42375),_=a(87692),p=a.n(_),x=a(53737),g=a(47924),v=a(22711),f=a(33786),y=a(84109),b=a(40592),w=a(12115),k=a(95799),A=a(3925),j=a(91540);d().extend(p()),d().locale(m());let N={...h.A,lang:{...h.A.lang,fieldDateFormat:"DD/MM/BBBB",fieldDateTimeFormat:"DD/MM/BBBB HH:mm:ss",yearFormat:"BBBB",cellYearFormat:"BBBB"}};function B(){let[e,t]=(0,w.useState)([]),[a,c]=(0,w.useState)(""),{RangePicker:d}=o.A,[u,m]=(0,w.useState)(""),[h,_]=(0,w.useState)(""),[p,B]=(0,w.useState)(null),[S,D]=(0,w.useState)(!0);(0,w.useEffect)(()=>{C()},[]);let C=async()=>{let e=localStorage.getItem("token");try{t([]);let a=await l.A.get("/publicAPI/fetchDataAllAttendanceRecord",{headers:{Authorization:"Bearer ".concat(e)}});200===a.status&&t(a.data.data)}catch(e){console.log(e)}finally{D(!1)}},I=e=>{c(e.target.value)};(0,w.useEffect)(()=>{""===a?(C(),B(null)):H()},[a]);let z=e.map((e,t)=>({...e,index:t+1})),R=[...new Set(z.map(e=>{var t;return null==e?void 0:null===(t=e.check_in_status)||void 0===t?void 0:t.check_in_status_name}))].map(e=>({text:e,value:e})),F=[{title:"ID",dataIndex:"index",sorter:(e,t)=>e.index-t.index,responsive:["md"],ellipsis:!0,width:"5rem"},{title:"ชื่อ-นามสกุล",dataIndex:"users",sorter:(e,t)=>e.users.fullname_thai.localeCompare(t.users.fullname_thai),ellipsis:!0,render:e=>e?"".concat(e.prefix," ").concat(e.fullname_thai):"-"},{title:"เข้างาน",dataIndex:"check_in_status",sorter:(e,t)=>e.check_in_status.check_in_status_name.localeCompare(t.check_in_status.check_in_status_name),ellipsis:!0,render:e=>(null==e?void 0:e.check_in_status_name)||"-",filters:R,onFilter:(e,t)=>t.check_in_status.check_in_status_name===e,width:"7rem"},{title:"เวลาเข้างาน",dataIndex:"starting",responsive:["lg"],sorter:(e,t)=>e.starting.localeCompare(t.starting),ellipsis:!0,width:"7rem"},{title:"ออกงาน",dataIndex:"check_out_status",sorter:(e,t)=>{var a,s;return(null===(a=e.check_out_status)||void 0===a?void 0:a.check_out_status_name)&&(null===(s=t.check_out_status)||void 0===s?void 0:s.check_out_status_name)?e.check_out_status.check_out_status_name.localeCompare(t.check_out_status.check_out_status_name):0},ellipsis:!0,render:e=>(null==e?void 0:e.check_out_status_name)||"ไม่มีข้อมูล",filters:[...new Set(z.map(e=>{var t;return null==e?void 0:null===(t=e.check_out_status)||void 0===t?void 0:t.check_out_status_name}))].map(e=>({text:e||"ไม่มีข้อมูล",value:e||"ไม่มีข้อมูล"})),onFilter:(e,t)=>{var a,s;return(null===(a=t.check_out_status)||void 0===a?void 0:a.check_out_status_name)===e||!(null===(s=t.check_out_status)||void 0===s?void 0:s.check_out_status_name)&&"ไม่มีข้อมูล"===e},width:"7rem"},{title:"เวลาออกงาน",dataIndex:"ending",responsive:["lg"],sorter:(e,t)=>e.ending&&t.ending?e.ending.localeCompare(t.ending):0,render:e=>e||"ไม่มีข้อมูล",ellipsis:!0,width:"7rem"},{title:"ประเภทวัน",dataIndex:"shift_types",responsive:["lg"],sorter:(e,t)=>e.shift_types.shift_type_name.localeCompare(t.shift_types.shift_type_name),render:e=>(null==e?void 0:e.shift_type_name)||"-",ellipsis:!0,filters:[...new Set(z.map(e=>{var t;return null==e?void 0:null===(t=e.shift_types)||void 0===t?void 0:t.shift_type_name}))].map(e=>({text:e||"ไม่มีข้อมูล",value:e||"ไม่มีข้อมูล"})),onFilter:(e,t)=>{var a;return(null===(a=t.shift_types)||void 0===a?void 0:a.shift_type_name)===e}},{title:"วันที่สร้าง",dataIndex:"created_at",render:e=>(0,n.r)(e),sorter:(e,t)=>e.created_at.localeCompare(t.created_at),ellipsis:!0},{title:"อัพเดทล่าสุด",dataIndex:"updated_at",render:e=>(0,n.r)(e),sorter:(e,t)=>e.updated_at.localeCompare(t.updated_at),ellipsis:!0}],H=async()=>{let e=localStorage.getItem("token");try{let s=await l.A.get("/publicAPI/searchAttendanceRecords/".concat(a),{headers:{Authorization:"Bearer ".concat(e)}});200===s.status&&(t(s.data.data),B(null))}catch(e){var s,n;""!==a&&t([]),B(null===(n=e.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)}},M=e=>{let[t,a,s]=e.split("/");m("".concat(s,"-").concat(t,"-").concat(a))},T=e=>{let[t,a,s]=e.split("/");_("".concat(s,"-").concat(t,"-").concat(a))},E=async()=>{let e=localStorage.getItem("token");if(!u||!h)return k.oR.warning("ไม่พบข้อมูลวันที่ ที่ต้องการค้นหา");try{let a=await l.A.get("/publicAPI/searchDateAttendanceRecord/".concat(u,"/").concat(h),{headers:{Authorization:"Bearer ".concat(e)}});200===a.status&&t(a.data.data)}catch(e){var a,s;t([]),k.oR.error(null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)}};return(0,s.jsxs)("div",{className:"bg-white p-4 rounded-xl select-none shadow-md",children:[(0,s.jsx)("div",{className:"my-2 font-semibold pl-1.5 bg-blue-900 rounded-md shadow-sm",children:(0,s.jsxs)("h1",{className:"bg-blue-50 p-2 pl-3 text-blue-900 flex gap-2 items-center",children:[(0,s.jsx)(x.A,{size:20}),"ข้อมูลลงเวลา เข้า - ออก",p&&(0,s.jsx)("p",{className:"text-red-600",children:p})]})}),(0,s.jsxs)("div",{className:"flex justify-between items-center px-2 my-4 gap-4",children:[(0,s.jsxs)("div",{className:"relative w-full md:w-1/3",children:[(0,s.jsx)(g.A,{className:"absolute top-1/2 left-3 transform -translate-y-1/2 text-gray-500",size:16,strokeWidth:2}),(0,s.jsx)("input",{className:"rounded-md text-sm px-4 py-2 w-full pl-10 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:e=>I(e),type:"text",placeholder:"ค้นหา..."})]}),(0,s.jsx)(b.Button,{className:"px-4 py-2 text-sm font-semibold disabled:opacity-50 rounded-md bg-green-800 hover:bg-green-700 transition-all text-white shadow-sm",onClick:()=>{let e=z.map(e=>{var t;return{รหัสการบันทึก:e.index,ชื่อผู้ใช้:"".concat(e.users.prefix," ").concat(e.users.fullname_thai),ประเภทการทำงาน:e.shift_types.shift_type_name,เวลาเริ่มต้น:e.starting,สถานะการเข้างาน:e.check_in_status.check_in_status_name,เวลาออก:e.ending||"null",สถานะการออกงาน:(null===(t=e.check_out_status)||void 0===t?void 0:t.check_out_status_name)||"null",เวลาบันทึก:new Date(e.created_at).toLocaleString("th-TH"),เวลาอัพเดท:new Date(e.updated_at).toLocaleString("th-TH")}}),t=A.Wp.json_to_sheet(e),a=A.Wp.book_new();A.Wp.book_append_sheet(a,t,"ข้อมูลการเข้าออกงาน");let s=new Blob([A.M9(a,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,j.saveAs)(s,"ข้อมูลการเข้าออกงาน.xlsx")},disabled:!z,label:(0,s.jsxs)("p",{className:"flex gap-1 items-center",children:[(0,s.jsx)(v.A,{size:15,strokeWidth:2})," บันทึก Excel ",(0,s.jsx)(f.A,{size:10})]})})]}),(0,s.jsxs)("div",{className:"my-4 px-2 grid grid-cols-1 md:grid-cols-3 gap-4 w-full md:w-2/3 lg:w-1/2",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"วันเริ่มต้น"}),(0,s.jsx)(o.A,{inputReadOnly:!0,className:"w-full border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:e=>M(new Date(null==e?void 0:e.$d).toLocaleDateString()),locale:N,placeholder:"เลือกวันที่..."})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"วันสิ้นสุด"}),(0,s.jsx)(o.A,{inputReadOnly:!0,disabled:!u,disabledDate:e=>!!u&&e.isBefore(u,"day"),className:"w-full border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",onChange:e=>T(new Date(null==e?void 0:e.$d).toLocaleDateString()),locale:N,placeholder:"เลือกวันที่..."})]}),(0,s.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,s.jsx)(b.Button,{onClick:E,className:"bg-blue-600 w-12 h-10 text-white rounded-md hover:bg-blue-500 transition-all shadow-sm",label:(0,s.jsx)(g.A,{className:"mx-auto",size:18})}),(0,s.jsx)(b.Button,{onClick:()=>C(),className:"bg-gray-500 w-12 h-10 text-white rounded-md hover:bg-gray-400 transition-all shadow-sm",label:(0,s.jsx)(y.A,{className:"mx-auto",size:18})})]})]}),(0,s.jsx)(r.A,{className:"overflow-x-auto font-sarabun min-h-fit border-gray-200 rounded-md",rowClassName:"font-sarabun hover:bg-gray-50",dataSource:z,locale:{emptyText:(0,s.jsx)(i.A,{description:"ไม่พบข้อมูล"})},rowKey:"index",rowHoverable:!0,columns:F,loading:S,scroll:{x:800},sortDirections:["ascend","descend","ascend"],showSorterTooltip:{title:"คลิกเพื่อเรียงลำดับ"},size:"small",pagination:{pageSizeOptions:[5,10,20,50,100],showSizeChanger:!0,defaultPageSize:10,showTotal:e=>"ทั้งหมด ".concat(e," รายการ")}})]})}},32383:()=>{},42414:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(23464);s.A.defaults.baseURL="https://akathos.moph.go.th/akatApi/";let l=s.A},57791:(e,t,a)=>{"use strict";a.d(t,{r:()=>n});var s=a(82940),l=a.n(s);let n=e=>l()(e).locale("th").add(543,"years").format("วันที่ DD/MM/YYYY เวลา HH:mm น.")},83686:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[586,3524,3464,4396,5799,592,437,9203,7529,8441,1684,7358],()=>t(17090)),_N_E=e.O()}]);