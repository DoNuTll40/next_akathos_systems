(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3826],{19946:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(12115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:u,className:s="",children:c,iconNode:d,...f}=e;return(0,r.createElement)("svg",{ref:t,...l,width:a,height:a,stroke:n,strokeWidth:u?24*Number(i)/Number(a):i,className:o("lucide",s),...f},[...d.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(c)?c:[c]])}),u=(e,t)=>{let n=(0,r.forwardRef)((n,l)=>{let{className:u,...s}=n;return(0,r.createElement)(i,{ref:l,iconNode:t,className:o("lucide-".concat(a(e)),u),...s})});return n.displayName="".concat(e),n}},20649:(e,t,n)=>{Promise.resolve().then(n.bind(n,84521))},28553:(e,t,n)=>{"use strict";n.d(t,{A:()=>c,h:()=>s});var r=n(95155),a=n(42414),o=n(35695),l=n(12115),i=n(95799);let u=(0,l.createContext)();function s(e){let{children:t}=e,[n,s]=(0,l.useState)(!1),[c,d]=(0,l.useState)(""),[f,p]=(0,l.useState)(!0),[v,y]=(0,l.useState)(null),[m,b]=(0,l.useState)(null),[g,h]=(0,l.useState)({username:"",password:""}),x=(0,o.useRouter)();(0,l.useEffect)(()=>{b(localStorage.getItem("token")),j()},[]);let O=async()=>await a.A.post("auth/authLogin",g),j=async()=>{var e,t;p(!0);let n=localStorage.getItem("token");if(b(n),!n)return p(!1);try{let t=await a.A.post("/auth/authVerifyToken",{},{headers:{Authorization:"Bearer ".concat(n)}});200===t.status&&(y(t.data.data),localStorage.setItem("isAuthen",JSON.stringify(null===(e=t.data)||void 0===e?void 0:e.data)))}catch(e){i.oR.error(null===(t=e.response)||void 0===t?void 0:t.data.message),localStorage.removeItem("token"),localStorage.removeItem("isAuthen"),y(null)}finally{p(!1)}},w=async()=>{var e,t;p(!0);try{let t=await a.A.post("/auth/authLogout",{},{headers:{Authorization:"Bearer ".concat(m)}});200===t.status&&(i.oR.success(null===(e=t.data)||void 0===e?void 0:e.message),localStorage.removeItem("token"),localStorage.removeItem("isAuthen"),x.push("/admin/login"),b(null),y(null))}catch(e){i.oR.error(null===(t=e.response)||void 0===t?void 0:t.data.message)}finally{p(!1)}};return(0,r.jsx)(u.Provider,{value:{inputLogin:g,setInputLogin:h,showModalOtp:n,setShowModalOtp:s,login:O,verify:j,logout:w,user:v,loading:f,setLoading:p,setToken:b,errMsg:c,setErrMsg:d},children:t})}let c=u},35695:(e,t,n)=>{"use strict";var r=n(18999);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},42414:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(23464);r.A.defaults.baseURL="https://akathos.moph.go.th/akatApi/";let a=r.A},81284:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=(0,n(19946).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},81726:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(28553),a=n(12115);function o(){return(0,a.useContext)(r.A)}},84521:(e,t,n)=>{"use strict";n.d(t,{default:()=>R});var r=n(95155),a=n(12115),o=n(4396),l=n(7740),i=n(27340),u=n(86080);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var c={DEFAULT_MASKS:{pint:/[\d]/,int:/[\d\-]/,pnum:/[\d\.]/,money:/[\d\.\s,]/,num:/[\d\-\.]/,hex:/[0-9a-f]/i,email:/[a-z0-9_\.\-@]/i,alpha:/[a-z_]/i,alphanum:/[a-z0-9_]/i},getRegex:function(e){return c.DEFAULT_MASKS[e]?c.DEFAULT_MASKS[e]:e},onBeforeInput:function(e,t,n){!n&&u.DV.isAndroid()&&this.validateKey(e,e.data,t)},onKeyPress:function(e,t,n){!(n||u.DV.isAndroid())&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&this.validateKey(e,e.key,t)},onPaste:function(e,t,n){if(!n){var r,a=this.getRegex(t);((function(e){if(Array.isArray(e))return s(e)})(r=e.clipboardData.getData("text"))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return s(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,void 0)}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).forEach(function(t){if(!a.test(t))return e.preventDefault(),!1})}},validateKey:function(e,t,n){null!=t&&t.length<=2&&(this.getRegex(n).test(t)||e.preventDefault())},validate:function(e,t){var n=e.target.value,r=!0,a=this.getRegex(t);return n&&!a.test(n)&&(r=!1),r}},d=n(16244);function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var v=l.x.extend({defaultProps:{__TYPE:"InputText",__parentMetadata:null,children:void 0,className:null,invalid:!1,variant:null,keyfilter:null,onBeforeInput:null,onInput:null,onKeyDown:null,onPaste:null,tooltip:null,tooltipOptions:null,validateOnly:!1,iconPosition:null},css:{classes:{root:function(e){var t=e.props,n=e.isFilled,r=e.context;return(0,u.xW)("p-inputtext p-component",{"p-disabled":t.disabled,"p-filled":n,"p-invalid":t.invalid,"p-variant-filled":t.variant?"filled"===t.variant:r&&"filled"===r.inputStyle})}}}});function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){!function(e,t,n){var r;r=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==p(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"===p(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var b=a.memo(a.forwardRef(function(e,t){var n=(0,i.qV)(),r=a.useContext(o.UM),s=v.getProps(e,r),p=v.setMetaData(m(m({props:s},s.__parentMetadata),{},{context:{disabled:s.disabled,iconPosition:s.iconPosition}})),y=p.ptm,b=p.cx,g=p.isUnstyled;(0,l.j)(v.css.styles,g,{name:"inputtext",styled:!0});var h=a.useRef(t);a.useEffect(function(){u.BF.combinedRefs(h,t)},[h,t]);var x=a.useMemo(function(){return u.BF.isNotEmpty(s.value)||u.BF.isNotEmpty(s.defaultValue)},[s.value,s.defaultValue]),O=u.BF.isNotEmpty(s.tooltip);a.useEffect(function(){x?u.DV.addClass(h.current,"p-filled"):u.DV.removeClass(h.current,"p-filled")},[s.disabled,x]);var j=n({className:(0,u.xW)(s.className,b("root",{context:r,isFilled:x})),onBeforeInput:function(e){s.onBeforeInput&&s.onBeforeInput(e),s.keyfilter&&c.onBeforeInput(e,s.keyfilter,s.validateOnly)},onInput:function(e){var t=e.target,n=!0;s.keyfilter&&s.validateOnly&&(n=c.validate(e,s.keyfilter)),s.onInput&&s.onInput(e,n),u.BF.isNotEmpty(t.value)?u.DV.addClass(t,"p-filled"):u.DV.removeClass(t,"p-filled")},onKeyDown:function(e){s.onKeyDown&&s.onKeyDown(e),s.keyfilter&&c.onKeyPress(e,s.keyfilter,s.validateOnly)},onPaste:function(e){s.onPaste&&s.onPaste(e),s.keyfilter&&c.onPaste(e,s.keyfilter,s.validateOnly)}},v.getOtherProps(s),y("root"));return a.createElement(a.Fragment,null,a.createElement("input",f({ref:h},j)),O&&a.createElement(d.m,f({target:h,content:s.tooltip,pt:y("tooltip")},s.tooltipOptions)))}));function g(){return(g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}}function O(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}b.displayName="InputText";var w=l.x.extend({defaultProps:{__TYPE:"InputOtp",__parentMetadata:null,className:null,modelValue:!1,invalid:!1,disabled:!1,readOnly:!1,variant:null,tabIndex:null,length:4,mask:!1,integerOnly:!1},css:{classes:{root:"p-inputotp p-component",input:"p-inputotp-input"}}});function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(t){!function(e,t,n){var r;r=function(e,t){if("object"!==j(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==j(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"===j(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var P=a.memo(a.forwardRef(function(e,t){var n,r,s,c=(0,a.useRef)(t),d=(0,i.qV)(),f=(0,a.useContext)(o.UM),p=w.getProps(e,f),v=w.setMetaData(A(A({props:p},p.__parentMetadata),{},{context:{disabled:p.disabled}})),y=v.ptm,m=v.cx,h=v.isUnstyled;(0,l.j)(w.css.styles,h,{name:"inputotp"});var j=p.value?null===(r=p.value)||void 0===r||null===(r=r.toString())||void 0===r||null===(s=r.split)||void 0===s?void 0:s.call(r,""):Array(p.length),S=function(e){if(Array.isArray(e))return e}(n=(0,a.useState)(j))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],u=!0,s=!1;try{o=(n=n.call(e)).next;for(;!(u=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){s=!0,a=e}finally{try{if(!u&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw a}}return i}}(n,2)||x(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),P=S[0],k=S[1],E=function(e){var t=e.nextElementSibling;if(t)return"INPUT"===t.nodeName?t:E(t)},N=function(e){var t=e.previousElementSibling;if(t)return"INPUT"===t.nodeName?t:N(t)},I=function(e){var t=E(e.target);t&&(t.focus(),t.select())},D=function(e){var t=N(e.target);t&&(t.focus(),t.select())},T=function(e,t){var n;null==p||null===(n=p.onChange)||void 0===n||n.call(p,{originalEvent:e,value:t.join("")})},R=function(e,t){var n=e.target.value,r=O(P);r[t]=n,k(r=(r=r.join(""))?r.split(""):Array(p.length)),T(e,r)},_=function(e,t){!p.disabled&&!p.readOnly&&"insertFromPaste"!==e.nativeEvent.inputType&&(R(e,t),"deleteContentBackward"===e.nativeEvent.inputType?D(e):("insertText"===e.nativeEvent.inputType||"deleteContentForward"===e.nativeEvent.inputType)&&I(e))},C=function(e){if(!p.disabled&&!p.readOnly){var t=e.clipboardData.getData("text");if(t.length){var n=t.substring(0,p.length+1);if(!p.integerOnly||!isNaN(n)){var r=n.split("");k(r),T(e,r)}}}},B=function(e){var t;e.target.select(),null==p||null===(t=p.focus)||void 0===t||t.call(p,e)},K=function(e){var t;null==p||null===(t=p.blur)||void 0===t||t.call(p,e)},M=function(e){if(!p.disabled&&!p.readOnly&&!e.altKey&&!e.ctrlKey&&!e.metaKey)switch(e.code){case"ArrowLeft":D(e),e.preventDefault();break;case"ArrowRight":I(e),e.preventDefault();break;case"Backspace":var t;(null===(t=e.target)||void 0===t||null===(t=t.value)||void 0===t?void 0:t.length)===0&&(D(e),e.preventDefault());break;case"ArrowUp":case"ArrowDown":e.preventDefault();break;case"Tab":case"Enter":break;default:(null!=p&&p.integerOnly&&!("Space"!==e.code&&Number(e.key)>=0&&9>=Number(e.key))||P.join("").length>=p.length&&"Delete"!==e.code)&&e.preventDefault()}};(0,i.w5)(function(){var e,t;k(p.value?null===(e=p.value)||void 0===e||null===(e=e.toString())||void 0===e||null===(t=e.split)||void 0===t?void 0:t.call(e,""):Array(p.length))},[p.value]);var F=function(e){if(e<=0)return[];var t=p.length-e,n={onInput:function(e){return _(e,t)},onKeyDown:M,onFocus:B,onBlur:K,onPaste:C},r={id:t,value:P[t]||"",inputMode:null!=p&&p.integerOnly?"numeric":"text",type:null!=p&&p.mask?"password":"text",variant:null==p?void 0:p.variant,readOnly:null==p?void 0:p.readOnly,disabled:null==p?void 0:p.disabled,invalid:null==p?void 0:p.invalid,tabIndex:null==p?void 0:p.tabIndex,unstyled:null==p?void 0:p.unstyled,"aria-label":(0,o.Y4)("otpLabel",{0:t+1}),className:m("input"),pt:y("input")};return[null!=p&&p.inputTemplate?u.BF.getJSXElement(null==p?void 0:p.inputTemplate,{events:n,props:r}):a.createElement(b,g({},r,n,{key:t}))].concat(O(F(e-1)))},U=d({className:m("root"),ref:c,style:null==p?void 0:p.style},y("root"));return a.createElement("div",U,F(p.length))}));P.displayName="InputOtp";var k=n(81726),E=n(40592),N=n(95799),I=n(81284),D=n(42414),T=n(35695);function R(){let{showModalOtp:e,login:t,setShowModalOtp:n,verify:o,setInputLogin:l,user:i}=(0,k.A)(),[u,s]=(0,a.useState)(""),[c,d]=(0,a.useState)(300),[f,p]=(0,a.useState)(!1),[v,y]=(0,a.useState)(""),m=(0,a.useRef)(null),b=(0,T.useRouter)();(0,a.useEffect)(()=>{if(m.current&&e){let e=m.current.querySelector("input");null==e||e.focus()}},[e]),(0,a.useEffect)(()=>{e&&(d(300),p(!1))},[e]),(0,a.useEffect)(()=>{if(e){if(c>0){let e=setInterval(()=>{d(e=>e>0?e-1:0)},1e3);return()=>clearInterval(e)}p(!0)}},[c,e]);let g=async e=>{var t,r,a;let i=localStorage.getItem("token");try{let r=await D.A.post("/auth/authVerifyOtp",{otpCode:e},{headers:{Authorization:"Bearer ".concat(i)}});200===r.status&&(N.oR.success(null===(t=r.data)||void 0===t?void 0:t.message),d(300),n(!1),o(),l({username:"",password:""}),b.push("/admin"))}catch(e){N.oR.error(null===(r=e.response)||void 0===r?void 0:r.data.message),y(null===(a=e.response)||void 0===a?void 0:a.data.message)}},h=async()=>{try{let e=await t();200===e.status&&(N.oR.success("ระบบทำการส่ง OTP ใหม่เรียบร้อยแล้ว"),d(300),p(!1),y(null))}catch(t){var e;N.oR.error(null===(e=t.response)||void 0===e?void 0:e.data.message)}};return(0,r.jsx)(r.Fragment,{children:e&&(0,r.jsx)("div",{className:"fixed border h-screen w-screen bg-black/40 top-0 z-50 flex items-center justify-center p-4 select-none shadow-xl",children:(0,r.jsxs)("div",{className:"font-sans bg-white/85 backdrop-blur-xl p-4 rounded-xl min-h-2/4 w-90 ",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 my-4",children:[(0,r.jsx)("h1",{className:"text-center font-bold text-xl",children:"กรอก OTP"}),(0,r.jsx)("p",{children:"ระบบได้ทำการส่งหมายเลข OTP ไปยังบัญชี Telegram ของคุณเป็นที่เรียบร้อยแล้วโปรตรวจสอบที่บัญชีของคุณ"})]}),(0,r.jsx)("div",{className:"text-center text-black text-sm mb-4",children:f?"หมดเวลา กรุณากดส่ง OTP อีกครั้ง":(0,r.jsxs)("p",{className:"flex justify-center items-center gap-1",children:["OTP จะหมดอายุใน"," ",(0,r.jsx)("pre",{className:"px-2 bg-gray-300 rounded-sm font-sans font-semibold",children:(e=>{let t=Math.floor(e/60),n=e%60;return"".concat(t,":").concat(n<10?"0":"").concat(n)})(c)})," ","นาที"]})}),v&&(0,r.jsx)("div",{className:"bg-red-700 rounded-md mb-2 mt-4 animate-popUp shadow",children:(0,r.jsx)("div",{className:"bg-red-200 ml-1.5 rounded-r-md pl-2",children:(0,r.jsxs)("p",{className:"text-red-700 font-semibold text-sm py-2 flex items-start gap-1 drop-shadow-sm",children:[(0,r.jsx)(I.A,{size:20}),v]})})}),(0,r.jsx)("div",{className:"flex justify-center",ref:m,children:(0,r.jsx)(P,{length:6,integerOnly:!0,onChange:e=>{let t=e.value;s(t),6===t.length&&g(t)},value:u,inputTemplate:e=>{let{events:t,props:n}=e;return(0,r.jsx)("input",{...t,...n,type:"text",autoComplete:"off",className:"p-inputotp-input p-inputtext p-component font-semibold text-lg p-filled select-none disabled:opacity-50 disabled:cursor-not-allowed"},n.id)},invalid:6===u.length?"true":void 0,disabled:f,unstyled:void 0})}),(0,r.jsx)("div",{className:"mt-12 flex justify-center",children:(0,r.jsx)(E.Button,{disabled:!f,onClick:()=>h(),className:"w-3/4 px-2 py-1.5 text-white bg-blue-600 hover:bg-blue-500 disabled:opacity-50 rounded-full transition",label:"ส่งอีกครั้ง"})})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[3464,4396,5799,592,8441,1684,7358],()=>t(20649)),_N_E=e.O()}]);