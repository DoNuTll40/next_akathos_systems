(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5575],{1802:(e,t,a)=>{Promise.resolve().then(a.bind(a,72446))},15881:(e,t,a)=>{"use strict";a.d(t,{a:()=>r});var s=a(30402);a(7075);let r=async e=>{let t="@_!_AkAtHoSpItAl_!_@_1_1_0_9_8_@";if(!t)throw Error("Key is not defined in .env");return"object"==typeof e&&(e=JSON.stringify(e)),s.encrypt(e,t).toString()}},28553:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,h:()=>i});var s=a(95155),r=a(42414),l=a(35695),n=a(12115),o=a(95799);let d=(0,n.createContext)();function i(e){let{children:t}=e,[a,i]=(0,n.useState)(!1),[c,u]=(0,n.useState)(""),[h,m]=(0,n.useState)(!0),[p,x]=(0,n.useState)(null),[v,y]=(0,n.useState)(null),[g,f]=(0,n.useState)({username:"",password:""}),j=(0,l.useRouter)();(0,n.useEffect)(()=>{y(localStorage.getItem("token")),b()},[]);let k=async()=>await r.A.post("auth/authLogin",g),b=async()=>{var e,t;m(!0);let a=localStorage.getItem("token");if(y(a),!a)return m(!1);try{let t=await r.A.post("/auth/authVerifyToken",{},{headers:{Authorization:"Bearer ".concat(a)}});200===t.status&&(x(t.data.data),localStorage.setItem("isAuthen",JSON.stringify(null===(e=t.data)||void 0===e?void 0:e.data)))}catch(e){o.oR.error(null===(t=e.response)||void 0===t?void 0:t.data.message),localStorage.removeItem("token"),localStorage.removeItem("isAuthen"),x(null)}finally{m(!1)}},A=async()=>{var e,t;m(!0);try{let t=await r.A.post("/auth/authLogout",{},{headers:{Authorization:"Bearer ".concat(v)}});200===t.status&&(o.oR.success(null===(e=t.data)||void 0===e?void 0:e.message),localStorage.removeItem("token"),localStorage.removeItem("isAuthen"),j.push("/admin/login"),y(null),x(null))}catch(e){o.oR.error(null===(t=e.response)||void 0===t?void 0:t.data.message)}finally{m(!1)}};return(0,s.jsx)(d.Provider,{value:{inputLogin:g,setInputLogin:f,showModalOtp:a,setShowModalOtp:i,login:k,verify:b,logout:A,user:p,loading:h,setLoading:m,setToken:y,errMsg:c,setErrMsg:u},children:t})}let c=d},42414:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(23464);s.A.defaults.baseURL="https://akathos.moph.go.th/akatApi/";let r=s.A},50477:()=>{},72446:(e,t,a)=>{"use strict";a.d(t,{default:()=>y});var s=a(95155);a(42414),a(15881);var r=a(81726),l=a(81284),n=a(19946);let o=(0,n.A)("UserRound",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]),d=(0,n.A)("RectangleEllipsis",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M7 12h.01",key:"eqddd0"}]]),i=(0,n.A)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),c=(0,n.A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var u=a(70306),h=a(6874),m=a.n(h),p=a(40592),x=a(12115),v=a(95799);function y(){let{login:e,inputLogin:t,setInputLogin:a,showModalOtp:n,setShowModalOtp:h,setToken:y,errMsg:g,setErrMsg:f}=(0,r.A)(),[j,k]=(0,x.useState)(!1),[b,A]=(0,x.useState)(!1),w=async t=>{t.preventDefault(),A(!0);try{let t=await e();200===t.status&&(v.oR.success("โปรดยืนยัน OTP"),localStorage.setItem("token",t.data.token),y(t.data.token),h(!0))}catch(e){var a,s;f(null===(a=e.response)||void 0===a?void 0:a.data.message),v.oR.error(null===(s=e.response)||void 0===s?void 0:s.data.message)}finally{A(!1)}},N=e=>{f(null),a(t=>a({...t,[e.target.name]:e.target.value}))};return(0,s.jsxs)("div",{className:"mb-4 mt-2",children:[g&&(0,s.jsx)("div",{className:"bg-red-700 rounded-md mb-2 mt-4 animate-popUp shadow",children:(0,s.jsx)("div",{className:"bg-red-200 ml-1.5 rounded-r-md pl-2",children:(0,s.jsxs)("p",{className:"text-red-700 font-semibold text-sm py-2 flex items-start gap-1 drop-shadow-sm",children:[(0,s.jsx)(l.A,{size:20}),g]})})}),(0,s.jsxs)("form",{className:"flex flex-col",onSubmit:w,children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1 my-2",children:[(0,s.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,s.jsx)(o,{size:20,strokeWidth:1}),(0,s.jsx)("p",{children:"ชื่อผู้ใช้งาน"})]}),(0,s.jsx)("input",{name:"username",value:null==t?void 0:t.username,className:"w-full rounded-md transition py-2 text-md md:text-sm",onChange:N,placeholder:"ชื่อผู้ใช้งาน",type:"text",autoComplete:"username webauthn",required:!0})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 my-2",children:[(0,s.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,s.jsx)(d,{size:20,strokeWidth:1}),(0,s.jsx)("p",{children:"รหัสผ่าน"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 select-none hover:cursor-pointer bg-white p-1",onClick:()=>k(!j),children:j?(0,s.jsx)(i,{size:20,strokeWidth:1}):(0,s.jsx)(c,{size:20,strokeWidth:1})}),(0,s.jsx)("input",{name:"password",value:null==t?void 0:t.password,className:"w-full rounded-md transition py-2 text-md md:text-sm",onChange:N,placeholder:"●●●●●",type:j?"text":"password",autoComplete:"current-password",required:!0})]})]}),(0,s.jsx)("div",{className:"mt-8 mb-2",children:(0,s.jsx)(p.Button,{className:"border w-full rounded-full py-2 bg-green-800 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-green-700 text-white transition",type:"submit",disabled:b||n,label:(0,s.jsx)("div",{className:"flex items-center justify-center gap-1 font-semibold animate-fadeIn",children:b||n?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("span",{className:"border-gray-300 h-6 w-6 animate-spin rounded-full border-3 border-t-blue-900"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.A,{strokeWidth:3,size:16}),(0,s.jsx)("p",{children:"ยืนยัน"})]})})})}),(0,s.jsx)(m(),{className:"text-center text-xs mt-5 hover:underline underline-offset-2 hover:text-blue-800 transition",href:"/admin/auth/sign-in",children:"สร้างผู้ใช้งาน"})]})]})}},81726:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(28553),r=a(12115);function l(){return(0,r.useContext)(s.A)}}},e=>{var t=t=>e(e.s=t);e.O(0,[3464,4396,5799,592,6874,4196,8441,1684,7358],()=>t(1802)),_N_E=e.O()}]);